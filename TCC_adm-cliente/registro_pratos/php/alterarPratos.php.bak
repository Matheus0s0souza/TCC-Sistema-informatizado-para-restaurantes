<?php
include_once "../conexao.php";
include_once "../controlePratos.php";
include_once "../clsPratos.php";
$cad = new clsPratos($conexao);


$Prato          = filter_input(INPUT_POST,"Prato");
$PratoIngr1     = filter_input(INPUT_POST,"PratoIngr1");
$PratoIngr2     = filter_input(INPUT_POST,"PratoIngr2");
$PratoIngr3     = filter_input(INPUT_POST,"PratoIngr3");
$PrecoPrato     = filter_input(INPUT_POST,"PrecoPrato");
$Desconto       = filter_input(INPUT_POST,"desconto");
$ValTot         = $PrecoPrato-($PrecoPrato*($Desconto/100));


$cad->setPrato($Prato);
$cad->setPratoIngr1($PratoIngr1);
$cad->setPratoIngr2($PratoIngr2);
$cad->setPratoIngr3($PratoIngr3);
$cad->setPrecoPrato($PrecoPrato);
$cad->setDesconto($Desconto);
$cad->setValTot($ValTot);

if(isset($_POST["Alterar"])) //mudar os nomes das funções
{
    
    $cad->setidPrato($_POST["idPrato"]);

 //alterar imagem--------------------------------------------------------------------
      
/*

    $ImgAtual = $_FILES["Img"]["name"]; //não definindo quando consulta
    $ImgTemp  = $_FILES["Img"]["tmp_name"]; //não definindo quando consulta
    //comando para pegar na raiz do servidor
    //$Destino  = $_SERVER['DOCUMENT_ROOT'] . '/projeto_tcc_adm_upload_img/funcionarios/imagem/'.$ImgAtual;
    $Destino  ='../imagem/'.$ImgAtual;

    $cad->setImgAtual($ImgAtual);
    $cad->setImgtemp($ImgTemp);
    $cad->setDestino($Destino);

    echo "Temp File: " . $ImgTemp . "<br>";
    echo "Destination: " . $Destino . "<br>";
    echo "Upload Error: " . $_FILES["Img"]["error"] . "<br>";

    if ($_FILES["Img"]["error"] == UPLOAD_ERR_OK) {
        if (move_uploaded_file($ImgTemp, $Destino)) {
            // File moved successfully
        } else {
            // Error moving file
            echo "Failed to move file to destination";
        }
    } else {
        // Handle file upload error
        echo "File upload error: " . $_FILES["Img"]["error"];
    }
$dado = $cad->AlterarImg();
echo $dado;
echo "<script>javascript:window.location='../index.php';</script>";

*/
//-----------------------------------------------------------------------------------------------------------------
        $dado = $cad->Alterar();
        //var_dump($_FILES);
        //var_dump($dado);

        echo $dado;
        echo "<script>javascript:window.location='../index.php';</script>";
}


?>